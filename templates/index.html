<!DOCTYPE html>
<html>
<head>
    <title>Kart Manager - Riparazioni</title>
    <link rel="icon" type="image/png" href="https://www.k1speed.com/wp-content/uploads/2025/10/k1speed-logo-short-red.png">
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>

<div class="overlay">

    <h1>üîß Storico Riparazioni</h1>

    <div class="top-nav">
        <a href="/" class="nav-btn">Gestione Riparazioni</a>
        <a href="/karts" class="nav-btn">üèéÔ∏è Gestione Kart</a>
        <a href="/parts" class="nav-btn">üõ†Ô∏è Gestione Pezzi</a>
        <a href="/technicians" class="nav-btn">üë®‚Äçüîß Gestione Tecnici</a>
    </div>

    <!-- FILTRI RIPARAZIONI -->
    <form method="get" class="filter-form">
        <select name="kart_id">
            <option value="">Tutti i Kart</option>
            {% for k in karts %}
            <option value="{{ k[0] }}" {% if selected_kart == k[0]|string %}selected{% endif %}>
                #{{ k[1] }} - {{ k[2] }}
            </option>
            {% endfor %}
        </select>

        <select name="pezzo_id">
            <option value="">Tutti i Pezzi</option>
            {% for p in parts %}
            <option value="{{ p[0] }}" {% if selected_pezzo == p[0]|string %}selected{% endif %}>
                {{ p[1] }} ({{ p[2] }})
            </option>
            {% endfor %}
        </select>

        <input type="date" name="data_riparazione" value="{{ selected_data }}">

        <button type="submit">Filtra</button>
        <a href="/" class="btn">Reset</a>
    </form>


    <!-- aggiungi riparazione -->
    <form action="/add_repair" method="post" class="add-repair-form">
        <select name="kart_id" required>
            <option value="" disabled selected>Seleziona Kart</option>
            {% for k in karts %}
            <option value="{{ k[0] }}">#{{ k[1] }} - {{ k[2] }}</option>
            {% endfor %}
        </select>

        <select name="pezzo_id" required>
            <option value="" disabled selected>Seleziona Pezzo</option>
            {% for p in parts %}
            <option value="{{ p[0] }}">{{ p[1] }} ({{ p[2] }})</option>
            {% endfor %}
        </select>

        <select name="tecnico_id" required>
            <option value="" disabled selected>Seleziona Tecnico</option>
            {% for t in technicians %}
            <option value="{{ t[0] }}">{{ t[1] }} {{ t[2] }}</option>
            {% endfor %}
        </select>

        <input type="date" name="data_riparazione" required>
        <input type="number" name="quantit√†" min="1" placeholder="Quantit√†" required>
        <input type="text" name="descrizione" placeholder="Descrizione">
        <button type="submit">‚ûï Aggiungi Riparazione</button>


    </form>

    <!-- Tabella riparazioni -->
    <table>
        <tr>
            <th>ID</th>
            <th>Kart</th>
            <th>Pezzo</th>
            <th>Tecnico</th>
            <th>Data</th>
            <th>Quantit√†</th>
            <th>Descrizione</th>
            <th>Azioni</th>
        </tr>

        {% for r in repairs %}
        <tr>
            <td>{{ r[0] }}</td>
            <td>{{ r[1] }}</td>
            <td>{{ r[2] }}</td>
            <td>{{ r[3] }}</td>
            <td>{{ r[4] }}</td>
            <td>{{ r[5] }}</td>
            <td>{{ r[6] }}</td>
            <td>
                <a class="btn delete" href="/remove_repair/{{ r[0] }}">‚ùå Elimina</a>
            </td>
        </tr>
        {% endfor %}
    </table>

</div>

</body>
</html>
